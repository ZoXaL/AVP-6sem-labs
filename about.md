# Условия лабораторных работ

Стандартную функцию time использовать нельзя. Альтренативы:

* GetTickCount()
* rdtsc/__rdstc()

Компилировать только с опцией O2 и выше. Для VS — Release-режим.

## Лаба 1 — векторизация

Перемножиь матрицы мартиц. Размеры — float/double. Транспонировать матрицы нельзя. Обычно внешняя размером под 800х800 - 1200х1200, без векторизации занимает около секунды. 
* включить векторизацию (ускорение в 2.5-3 раза)
* выключить векторизацию (IA32)
* С выключенной векторизацией: использовать SSE2 (или подобное AVX/AVX2)
    - asm, было бы круто если версия будет быстрее чем векторизованная
    - intrinsics
      В идеале эта версия должна быть самая быстрая, раза в полтора-два быстрее невекторизированной. 
      - MMX (устаревшая) — 64 бит регистр
      - SSE — 128 бит
      - AVX — 256 бит, AVX2 — 512 бит
* Для всех вариантов сделать проверку, что результаты сходятся

Для успешной векторизации:

* итерации цикла должны быть независимы: a[i] = a[i-1] — зависимость

* длина массива известна заранее (было бы круто убедить компилятор, что данные будут кратны и что он сможет векторизировать даже при динамическом размене)

* минимум ветвлений/функций, если компилятор не сможет их просчитать, векторизация не пройдет

* веторизовать нужно только внутренний цикл. Вопрос? что может сделать компилятор, чтобы векторизовать и предпоследний цикл

  Задание: внутренняя матрица 4х4, данные типа double

## Лаба 2 — кэш и параллельность

Необходимо перемножить две большие матрицы, используя оптимизацию через кэш и многопоточное выполнение. 

* Включаем распараллеливание вычислений. OpenMP
* Используем оптимизацию на кэш. 
  * Матрицы перемножаются по блокам, которые целиком могут быть загружены в кэш. 
  * Для определения размера блока делим кэш примерно на три части (+ запас для других программ). 
  * Полный размер матрицы должен быть значительно больше размера кэша и не влезать в него полностью
* Improvement. Спроектировать работу системы для блоков разного уровня для возможности проверки на кэшах разного уровня. 